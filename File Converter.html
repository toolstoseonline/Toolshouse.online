<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>File Converter - Image Format Tool</title>

<style>
*{
margin:0;
padding:0;
box-sizing:border-box;
font-family:Segoe UI, sans-serif;
}

body{
min-height:100vh;
display:flex;
justify-content:center;
align-items:center;
background:linear-gradient(135deg,#667eea,#764ba2);
padding:20px;
}

.card{
background:#fff;
width:100%;
max-width:650px;
padding:30px;
border-radius:20px;
box-shadow:0 25px 50px rgba(0,0,0,0.2);
text-align:center;
}

h2{
margin-bottom:20px;
}

.drop-area{
border:2px dashed #764ba2;
padding:25px;
border-radius:15px;
cursor:pointer;
transition:0.3s;
}

.drop-area:hover{
background:#f3f0ff;
}

.preview-container{
margin-top:20px;
display:flex;
flex-wrap:wrap;
gap:10px;
justify-content:center;
}

.preview-box{
flex:1 1 45%;
}

canvas,img{
width:100%;
border-radius:12px;
box-shadow:0 5px 15px rgba(0,0,0,0.2);
}

select,button{
margin-top:15px;
padding:12px;
width:100%;
border:none;
border-radius:12px;
font-size:16px;
}

select{
border:1px solid #ccc;
}

button{
background:#764ba2;
color:white;
cursor:pointer;
transition:0.3s;
}

button:hover{
transform:translateY(-2px);
box-shadow:0 10px 20px rgba(0,0,0,0.2);
}

.loader{
display:none;
margin-top:15px;
}

.loader div{
width:25px;
height:25px;
border:4px solid #764ba2;
border-top:4px solid transparent;
border-radius:50%;
animation:spin 1s linear infinite;
margin:auto;
}

@keyframes spin{
100%{transform:rotate(360deg);}
}

@media(max-width:600px){
.preview-box{flex:1 1 100%;}
.card{padding:20px;}
}
</style>
</head>

<body>

<div class="card">
<h2>Image File Converter</h2>

<div class="drop-area" id="dropArea">
Drag & Drop Image Here<br>or Click to Upload
<input type="file" id="fileInput" hidden accept="image/*">
</div>

<div class="preview-container">
<div class="preview-box">
<h4>Original</h4>
<img id="originalPreview">
</div>
<div class="preview-box">
<h4>Converted</h4>
<canvas id="canvasPreview"></canvas>
</div>
</div>

<select id="formatSelect">
<option value="image/png">Convert to PNG</option>
<option value="image/jpeg">Convert to JPG</option>
<option value="image/webp">Convert to WEBP</option>
</select>

<button id="convertBtn">Convert File</button>
<button id="downloadBtn" style="display:none;">Download File</button>

<div class="loader"><div></div></div>

</div>

<script>
const dropArea=document.getElementById("dropArea");
const fileInput=document.getElementById("fileInput");
const originalPreview=document.getElementById("originalPreview");
const canvas=document.getElementById("canvasPreview");
const ctx=canvas.getContext("2d");
const convertBtn=document.getElementById("convertBtn");
const downloadBtn=document.getElementById("downloadBtn");
const formatSelect=document.getElementById("formatSelect");
const loader=document.querySelector(".loader");

let currentImage=null;
let convertedDataURL=null;

dropArea.addEventListener("click",()=>fileInput.click());

dropArea.addEventListener("dragover",(e)=>e.preventDefault());

dropArea.addEventListener("drop",(e)=>{
e.preventDefault();
handleFile(e.dataTransfer.files[0]);
});

fileInput.addEventListener("change",(e)=>{
handleFile(e.target.files[0]);
});

function handleFile(file){
if(!file || !file.type.startsWith("image/")){
alert("Please upload a valid image file.");
return;
}

const reader=new FileReader();
reader.onload=function(e){
originalPreview.src=e.target.result;
currentImage=new Image();
currentImage.src=e.target.result;
};
reader.readAsDataURL(file);

downloadBtn.style.display="none";
}

convertBtn.addEventListener("click",()=>{
if(!currentImage){
alert("Upload image first.");
return;
}

loader.style.display="block";

setTimeout(()=>{
canvas.width=currentImage.width;
canvas.height=currentImage.height;
ctx.drawImage(currentImage,0,0);

const format=formatSelect.value;
convertedDataURL=canvas.toDataURL(format,0.9);

downloadBtn.style.display="block";
loader.style.display="none";
},300);
});

downloadBtn.addEventListener("click",()=>{
if(!convertedDataURL) return;

const link=document.createElement("a");
link.href=convertedDataURL;

let extension="png";
if(formatSelect.value==="image/jpeg") extension="jpg";
if(formatSelect.value==="image/webp") extension="webp";

link.download="converted."+extension;
link.click();
});
</script>

</body>
</html>
