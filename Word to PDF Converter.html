<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Word to PDF Converter</title>

<!-- Mammoth for DOCX reading -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.4.2/mammoth.browser.min.js"></script>

<!-- jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>

<body style="font-family:Arial;text-align:center;margin-top:100px;">

<h2>Word (.docx) to PDF Converter</h2>

<input type="file" id="fileInput" accept=".docx">
<br><br>
<button onclick="convert()">Convert to PDF</button>

<script>
async function convert() {

    const file = document.getElementById("fileInput").files[0];

    if (!file) {
        alert("Please upload a DOCX file.");
        return;
    }

    if (!file.name.endsWith(".docx")) {
        alert("Only DOCX supported.");
        return;
    }

    const reader = new FileReader();

    reader.onload = async function(e) {

        try {

            const arrayBuffer = e.target.result;

            const result = await mammoth.extractRawText({ arrayBuffer: arrayBuffer });

            const text = result.value;

            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF();

            const lines = pdf.splitTextToSize(text, 180);
            pdf.text(lines, 10, 10);

            pdf.save(file.name.replace(".docx", "") + ".pdf");

        } catch (error) {
            alert("Conversion failed.");
            console.error(error);
        }

    };

    reader.readAsArrayBuffer(file);
}
</script>

</body>
</html>
