<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Word to PDF Converter</title>

<!-- Mammoth for DOCX reading -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.4.2/mammoth.browser.min.js"></script>

<!-- jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
    font-family: 'Segoe UI', sans-serif;
}

body{
    height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    background:linear-gradient(135deg,#667eea,#764ba2);
}

.card{
    background:#ffffff;
    width:95%;
    max-width:450px;
    padding:40px 30px;
    border-radius:20px;
    box-shadow:0 25px 50px rgba(0,0,0,0.2);
    text-align:center;
    animation:fadeIn 0.6s ease;
}

h2{
    margin-bottom:25px;
    color:#333;
}

.file-input{
    margin-bottom:20px;
}

input[type="file"]{
    padding:10px;
    border:2px dashed #764ba2;
    border-radius:12px;
    width:100%;
    cursor:pointer;
    transition:0.3s;
}

input[type="file"]:hover{
    background:#f3f0ff;
}

button{
    width:100%;
    padding:12px;
    border:none;
    border-radius:12px;
    background:#764ba2;
    color:white;
    font-size:16px;
    font-weight:600;
    cursor:pointer;
    transition:0.3s;
}

button:hover{
    background:#5a3796;
    transform:translateY(-2px);
    box-shadow:0 10px 20px rgba(0,0,0,0.2);
}

.footer-text{
    margin-top:15px;
    font-size:13px;
    color:#888;
}

@keyframes fadeIn{
    from{opacity:0; transform:translateY(20px);}
    to{opacity:1; transform:translateY(0);}
}

@media(max-width:480px){
    .card{
        padding:30px 20px;
    }
}
</style>

</head>

<body>

<div class="card">
    <h2>Word (.docx) to PDF Converter</h2>

    <div class="file-input">
        <input type="file" id="fileInput" accept=".docx">
    </div>

    <button onclick="convert()">Convert to PDF</button>

    <div class="footer-text">
        Fast • Secure • No Upload to Server
    </div>
</div>

<script>
async function convert() {

    const file = document.getElementById("fileInput").files[0];

    if (!file) {
        alert("Please upload a DOCX file.");
        return;
    }

    if (!file.name.endsWith(".docx")) {
        alert("Only DOCX supported.");
        return;
    }

    const reader = new FileReader();

    reader.onload = async function(e) {

        try {

            const arrayBuffer = e.target.result;

            const result = await mammoth.extractRawText({ arrayBuffer: arrayBuffer });

            const text = result.value;

            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF();

            const lines = pdf.splitTextToSize(text, 180);
            pdf.text(lines, 10, 10);

            pdf.save(file.name.replace(".docx", "") + ".pdf");

        } catch (error) {
            alert("Conversion failed.");
            console.error(error);
        }

    };

    reader.readAsArrayBuffer(file);
}
</script>

</body>
</html>
